# Version 1.3.1 Release Notes

**Release Date:** November 6, 2025

## Overview

Version 1.3.1 includes critical bug fixes for the AWS cost tracking feature and user experience improvements.

## Changes

### Bug Fixes

#### CORS Fix for AWS Credentials Endpoint
- **Issue:** OPTIONS preflight requests to `/aws-credentials` endpoint were returning 500 Internal Server Error, blocking credential save operations
- **Solution:** Modified Lambda function to handle OPTIONS requests directly instead of relying on API Gateway MOCK integration
- **Impact:** Users can now successfully save AWS IAM credentials for cost tracking
- **Files Modified:**
  - `lambda/aws-credentials.js` - Added OPTIONS handler with proper CORS headers

#### Logo Link Enhancement
- **Change:** Made Twin Wicks logo clickable on all pages, linking to https://twin-wicks.com
- **Implementation:** Wrapped logo images in anchor tags with `target="_blank"` and `rel="noopener noreferrer"`
- **Pages Affected:**
  - Login/Signup page (auth screen)
  - Main application header (all authenticated pages)
- **Files Modified:**
  - `frontend/index.html` - Added anchor tags around logo images

## Technical Details

### Lambda Function Changes

The `aws-credentials.js` Lambda function now includes an OPTIONS handler:

```javascript
// Handle OPTIONS for CORS preflight
if (method === 'OPTIONS') {
    return {
        statusCode: 200,
        headers: {
            'Access-Control-Allow-Origin': '*',
            'Access-Control-Allow-Methods': 'GET,POST,PUT,DELETE,OPTIONS',
            'Access-Control-Allow-Headers': 'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-User-Agent'
        },
        body: ''
    };
}
```

### API Gateway Configuration

- OPTIONS method configured with AWS_PROXY integration to Lambda function
- Lambda permission added for API Gateway to invoke OPTIONS method
- Deployment created to activate changes in production stage

### Frontend Changes

Logo markup changed from:
```html
<img src="logo.png" alt="Twin Wicks Digital Solutions" class="logo">
```

To:
```html
<a href="https://twin-wicks.com" target="_blank" rel="noopener noreferrer">
    <img src="logo.png" alt="Twin Wicks Digital Solutions" class="logo">
</a>
```

## Deployment

### Lambda Deployment
```bash
cd lambda
zip -r aws-credentials.zip aws-credentials.js node_modules
aws lambda update-function-code \
  --function-name expense-tracker-prod-aws-credentials \
  --zip-file fileb://aws-credentials.zip
```

### API Gateway Deployment
```bash
aws apigateway create-deployment \
  --rest-api-id fcnq8h7mai \
  --stage-name prod \
  --description "Configure OPTIONS with Lambda integration"
```

### Frontend Deployment
```bash
cd frontend
aws s3 sync . s3://expense-tracker-frontend-391907191624/ \
  --exclude "*.md" \
  --cache-control "max-age=0,no-cache,no-store,must-revalidate"

aws cloudfront create-invalidation \
  --distribution-id EB9MXBNYV9HVD \
  --paths "/*"
```

## Testing

### CORS Verification
```bash
curl -X OPTIONS https://fcnq8h7mai.execute-api.us-east-1.amazonaws.com/prod/aws-credentials -i
```

Expected response: HTTP 200 with CORS headers

### Logo Link Verification
- Navigate to https://app.twin-wicks.com
- Verify logo is clickable on login page
- Login and verify logo is clickable in header
- Confirm link opens https://twin-wicks.com in new tab

## Known Issues

None identified in this release.

## Upgrade Notes

This is a patch release with no breaking changes. All existing functionality remains intact.

## Contributors

- Manus AI Agent - CORS fix and logo link implementation

